<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="10">  <!-- Refresh every 10 seconds -->
    <title>Waiting for Approval</title>
    <script>
        // JavaScript to check if the user is active
        function checkVerification() {
            console.log("Checking verification status..."); // Log when the function is called

            // fetch("/user/check-verification-status/")  // Adjust to the correct endpoint
            fetch("http://localhost:8000/user/check-verification-status/")  // Full URL
            .then(response => {
                console.log("Received response:", response);  // Log the response

                return response.json();
            })
            .then(data => {
                console.log("Received data:", data);  // Log the data received from the API
                if (data.is_active) {
                    console.log("User is active, redirecting...");  // Log when user is active
                    window.location.href = "/";  // Redirect to home or another page
                } else {
                    console.log("User is still inactive");  // Log when user is inactive
                }
            })
            .catch(error => {
                console.error("Error fetching verification status:", error);  // Log any error
            });
        }

        // Poll the server every 10 seconds
        setInterval(checkVerification, 10000);  // Logs will be generated every 10 seconds
    </script>
</head>
<body>
    <h1>Thank you for registering, {{ user.first_name }}!</h1>
    <p>Your account is awaiting approval. Please check your email for further instructions.</p>
    <p>This page will refresh automatically, and you will be redirected once your account is verified.</p>
</body>
</html>
